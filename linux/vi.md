# vi

## 模式

- `命令行模式`：控制屏幕光标的移动，字符、字或行的删除，移动复制某区段及进入`插入模式`和`底行模式`
- `插入模式`：只有在`插入模式`下，才可以做文字输入，按`ESC`键可回到`命令行模式`
- `底行模式`：将文件保存或退出`vi`，也可以设置编辑环境，如寻找字符串、列出行号等

## 基本操作

- 进入vi后，是处于`命令行模式`，切换到`插入模式`才能够输入文字
- 在`命令行模式`下按一下字母`a`进入`插入模式`
- 如果要删除文字，要先按一下`ESC`键转到`命令行模式`才可删除
- 保存文件，在`命令行模式`下，按一下`:`冒号键进入`底行模式`，输入`w`并`回车`

## `命令行模式`功能键

- `.`：重复上一次的命令
- 保存文件
  - `:w`：保存
  - `:w!`：强制保存(只读文件)
  - `:w 文件名.txt`：另存为
  - `:q`：退出(未修改文件)
  - `:q!`：不保存文件退出
  - `:wq`：保存并退出
  - `:wq!`：强制保存并退出
  - `:set nu`：显示行号
  - `:set nonu`：不显示行号
  - `:! 命令`：暂时退出vi，执行命令并显示结果
  - `:g/^$/d`：删除空行
  - `:g/^\s*$/d`：删除包含空格的空行
- 进入`插入模式`
  - `a`：光标右侧输入
  - `i`：光标左侧输入
  - `A`：当前行尾输入
  - `I`：当前行首(非空字符)输入
  - `o`：当前行下一行输入
  - `O`：当前行上一行输入
  - `r`：替换当前光标字符
  - `R`：替换当前光标及后面字符(插入操作)
  - `s`：替换当前光标字符并输入
  - `S`：删除当前行内容并输入
  - `cw`：删除当前单词的光标开始处内容并输入
- 移动光标
  - `↑`、`Ctrl+Y`：上一行
  - `↓`、`Ctrl+E`：下一行
  - `←`：左一列
  - `→`：右一列
  - n`h`：左
  - n`j`：下
  - n`k`：上
  - n`l`：右
  - n`空格`：右
  - n`回退`：左
  - `0`：行首
  - `^`：非空字符行首
  - `$`：行尾
  - n`+`、n`确认`：下一行非空字符行首
  - n`-`：上一行非空字符行首
  - `gg`：第一行非空字符行首
  - `G`、`Shift+G`：最后一行非空字符行首
  - `:n`、`ngg`、`nG`：第n行非空字符行首
  - `H`：当前页第一行非空字符行首
  - `M`：当前页中间行非空字符行首
  - `L`：当前页最后一行非空字符行首
  - n`zt`：把当前行移动到页首
  - n`zz`：把当前行移动到页中
  - n`zb`：把当前行移动到页尾
  - n`b`：单词词首或上一个单词词首
  - n`e`：单词词尾或下一个单词词尾
  - n`w`：下一个单词词首
  - n`{`：上一个段落的空白行
  - n`}`：下一个段落的空白行
  - n`(`：上一个段落的空白行和第一行非空字符行首
  - n`)`：下一个段落的空白行和第一行非空字符行首
  - `Ctrl+F`：下一页
  - `Ctrl+B`：上一页
  - `Ctrl+D`：后半页
  - `Ctrl+U`：前半页
  - n`fx`：当前行下一个字符x
  - n`Fx`：当前行上一个字符x
  - n`tx`：当前行下一个字符x前
  - n`Tx`：当前行上一个字符x前
  - `%`：当前行向后查找括号`()[]{}`，不包括`<>`
- 删除(删除的内容保存在默认寄存器`"`中)和恢复
  - n`x`、n`删除`：删除当前字符
  - n`X`：删除前一个字符
  - n`dd`：删除当前行
  - `d0`：删除当前字符前到行首
  - `d^`：删除当前字符前到非空字符行首
  - `d$`：删除当前字符到行尾
  - `de`：删除当前字符到单词尾
  - `dE`：删除当前字符到单词尾(含标点符号)
  - `dw`：删除当前字符到单词尾以及后面空白字符
  - `dW`：删除当前字符到单词尾及后面空白字符(含标点符号)
  - `db`：删除当前字符前到单词首
  - `dB`：删除当前字符前到单词首(含标点符号)
  - n`D`：删除当前及后面字符
  - n`J`：当前行的`换行符`替换为`空格`
  - n`u`：撤销上一步操作
  - n`Ctrl+R`：重做撤销
  - `U`：撤销对当前行的所有操作
  - `d`、`""d`：删除选取内容，保存到默认寄存器`"`
  - `"+d`：删除选取内容，保存到系统剪贴板寄存器`+`
  - `"0d`：删除选取内容，保存到数字寄存器`0`(全部`0`-`9`)
  - `"ad`：删除选取内容，保存到字母寄存器`a`(全部`a`-`z`)
- 复制(复制的内容保存在默认寄存器`"`中)和粘贴
  - n`yy`：复制当前行
  - `y0`：复制当前字符前到行首
  - `y^`：复制当前字符前到非空字符行首
  - `y$`：复制当前字符到行尾
  - `ye`：复制当前字符到单词尾
  - `yE`：复制当前字符到单词尾(含标点符号)
  - `yw`：复制当前字符到单词尾以及后面空白字符
  - `yW`：复制当前字符到单词尾及后面空白字符(含标点符号)
  - `yb`：复制当前字符前到单词首
  - `yB`：复制当前字符前到单词首(含标点符号)
  - `p`：在光标之后粘帖默认寄存器`"`的内容
  - `P`：在光标之前粘帖默认寄存器`"`的内容
  - `"+p`：在光标之后粘帖系统剪贴板寄存器`+`的内容
  - `"+P`：在光标之前粘帖系统剪贴板寄存器`+`的内容
  - `"0p`：在光标之后粘帖数字寄存器`0`(全部`0`-`9`)的内容
  - `"0P`：在光标之前粘帖数字寄存器`0`(全部`0`-`9`)的内容
  - `"ap`：在光标之后粘帖字母寄存器`a`(全部`a`-`z`)的内容
  - `"aP`：在光标之前粘帖字母寄存器`a`(全部`a`-`z`)的内容
- 选取
  - `v`：正常选取
  - `Ctrl+V`：块选取
  - `gg0vG$`：全选
- 查找(向下搜索`/`向上搜索`?`)、替换、统计
  - `*`：向下搜索光标所在单词(等同于`/\<单词\>`)
  - `#`：向上搜索光标所在单词(等同于`?\<单词\>`)
  - `/字符串`、`/字符串\C`：向下搜索字符串(区分大小写)
  - `/字符串\c`：向下搜索字符串(不区分大小写)
  - `/\<字符串\>`：向下搜索字符串(全词匹配)
  - `/^字符串`：向下搜索以字符串开头的行
  - `/字符串$`：向下搜索以字符串结尾的行
  - `/字符串1|字符串2`：：向下搜索字符串1或字符串2
  - `n`：下一个目标
  - `N`：上一个目标
  - `:s/旧串/新串`：将当前行的第一个旧串替换为新串
  - `:s/旧串/新串/g`：将当前行的全部旧串替换为新串
  - `:2,5s/旧串/新串/g`：将2-5行的全部旧串替换为新串
  - `:2,$s/旧串/新串/g`：将2-尾行的全部旧串替换为新串
  - `:%s/旧串/新串/g`：将全部旧串替换为新串
  - `:%s/字符串/gn`：统计字符串在全文出现的次数
- 缓冲区
  - `:ls`：列出全部缓冲区
  - `:bn`：当前窗口显示下一个缓冲区内容
  - `:bp`：当前窗口显示上一个缓冲区内容
  - `:b2`：当前窗口显示2号缓冲区内容
  - `:bw`：删除当前窗口缓冲区，若当前窗口不是最后一个窗口则同时关闭窗口
- 标签页
  - `:tabnew`：新建`未命名`标签页
  - `:tabnew hello`：新建名为`hello`标签页
  - `:tabnew hello.c`：新建标签页打开文件
  - `:tabs`：列出全部标签页
  - `:tabn`：切换至下一个标签页
  - `:tabp`：切换至上一个标签页
  - `:tabc`：关闭当前标签页
- 窗口
  - `Ctrl+W,s`：将当前窗口分为上下两个窗口，指向同一个缓冲区
  - `Ctrl+W,v`：将当前窗口分为左右两个窗口，指向同一个缓冲区
  - `:sp hello.c`：将当前窗口分为上下两个窗口，打开文件显示在上窗口
  - `:vsp hello.c`：将当前窗口分为左右两个窗口，打开文件显示在左窗口
  - `Ctrl+W,h`：移动光标至左侧窗口
  - `Ctrl+W,j`：移动光标至下方窗口
  - `Ctrl+W,k`：移动光标至上方窗口
  - `Ctrl+W,l`：移动光标至右侧窗口
  - `Ctrl+W,H`：当前窗口左移
  - `Ctrl+W,J`：当前窗口下移
  - `Ctrl+W,K`：当前窗口上移
  - `Ctrl+W,L`：当前窗口右移
  - `Ctrl+W,q`：关闭当前窗口
